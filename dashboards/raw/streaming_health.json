{
  "name": "Streaming Ingestion Health",
  "description": "Monitor streaming ingestion jobs, throughput, and latency.",
  "tags": ["streaming", "databricks", "delta", "checkpoint"],
  "widgets": [
    {
      "title": "Streaming Job Runs (Last 1 Hour)",
      "visualization": "table",
      "query": {
        "sql": "SELECT source_name, target_table, run_time, get_json_object(validation_results, '$.row_count') AS rows FROM system.migration_logs WHERE run_time >= current_timestamp() - INTERVAL 1 HOUR ORDER BY run_time DESC"
      },
      "size": { "width": 12, "height": 6 },
      "position": { "x": 0, "y": 0 }
    },
    {
      "title": "Rows Per Trigger",
      "visualization": "line",
      "query": {
        "sql": "SELECT source_name, run_time, CAST(get_json_object(validation_results, '$.row_count') AS BIGINT) AS rows FROM system.migration_logs WHERE run_time >= current_timestamp() - INTERVAL 1 DAY ORDER BY run_time"
      },
      "size": { "width": 12, "height": 6 },
      "position": { "x": 0, "y": 6 }
    },
    {
      "title": "Schema Drift Alerts (Streaming Sources)",
      "visualization": "table",
      "query": {
        "sql": "SELECT source_name, run_time, get_json_object(validation_results, '$.schema_drift') AS schema_drift FROM system.migration_logs WHERE source_type = 'storage' AND get_json_object(validation_results, '$.schema_drift') NOT IN ('first_run','[]') ORDER BY run_time DESC"
      },
      "size": { "width": 12, "height": 6 },
      "position": { "x": 0, "y": 12 }
    }
  ]
}
